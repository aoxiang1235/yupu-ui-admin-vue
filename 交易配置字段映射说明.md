# 交易配置字段映射说明

## 一、前端到后端字段映射

### 1.1 字段命名规则
- 前端：驼峰命名（camelCase），如 `sameCityStartPrice`
- 后端：下划线命名（snake_case），如 `same_city_start_price`

### 1.2 金额字段转换规则

#### 需要转换的金额字段（前端元 → 后端分）

**快递发货配置**：
- `deliveryExpressFreePrice` → `delivery_express_free_price` (元 × 100 = 分)

**包装费配置**：
- `packagingFeePrice` → `packaging_fee_price` (元 × 100 = 分)

**分销配置**：
- `brokerageWithdrawMinPrice` → `brokerage_withdraw_min_price` (元 × 100 = 分)

**同城配送金额字段**（注意：前端代码中暂未转换，建议后端统一处理）：
- `sameCityStartPrice` → `same_city_start_price` (元 × 100 = 分)
- `sameCityExtraPrice` → `same_city_extra_price` (元 × 100 = 分)
- `sameCityFixedPrice` → `same_city_fixed_price` (元 × 100 = 分)
- `sameCityCustomMinPrice` → `same_city_custom_min_price` (元 × 100 = 分)
- `sameCityCustomMaxPrice` → `same_city_custom_max_price` (元 × 100 = 分)
- `sameCityCustomDefaultPrice` → `same_city_custom_default_price` (元 × 100 = 分)
- `sameCityFreePrice` → `same_city_free_price` (元 × 100 = 分)

**门店自配送金额字段**（注意：前端代码中暂未转换，建议后端统一处理）：
- `storeStartPrice` → `store_start_price` (元 × 100 = 分)
- `storeExtraPrice` → `store_extra_price` (元 × 100 = 分)
- `storeFixedPrice` → `store_fixed_price` (元 × 100 = 分)
- `storeCustomMinPrice` → `store_custom_min_price` (元 × 100 = 分)
- `storeCustomMaxPrice` → `store_custom_max_price` (元 × 100 = 分)
- `storeCustomDefaultPrice` → `store_custom_default_price` (元 × 100 = 分)
- `storeFreePrice` → `store_free_price` (元 × 100 = 分)

#### 不需要转换的数值字段
- 距离字段（公里）：直接存储，如 `sameCityStartDistance`
- 百分比字段：直接存储整数值，如 `brokerageFirstPercent`
- 坐标字段：直接存储，如 `sameCityDeliveryCenterLatitude`

### 1.3 JSON数组字段

以下字段在前端是数组，后端存储为JSON：

- `afterSaleRefundReasons` → `after_sale_refund_reasons` (JSON数组)
- `afterSaleReturnReasons` → `after_sale_return_reasons` (JSON数组)
- `brokeragePosterUrls` → `brokerage_poster_urls` (JSON数组)
- `brokerageWithdrawTypes` → `brokerage_withdraw_types` (JSON数组)

## 二、后端到前端字段映射

查询时，后端返回的数据需要：

1. **金额字段转换**：分 ÷ 100 = 元
2. **JSON字段解析**：JSON字符串 → 数组
3. **布尔字段转换**：TINYINT(1) → boolean
4. **null值处理**：NULL → undefined 或默认值

## 三、完整字段映射表

| 前端字段名 | 后端字段名 | 数据类型 | 转换规则 | 说明 |
|-----------|-----------|---------|---------|------|
| id | id | BIGINT | 无 | 主键 |
| afterSaleRefundReasons | after_sale_refund_reasons | JSON | JSON解析 | 退款理由列表 |
| afterSaleReturnReasons | after_sale_return_reasons | JSON | JSON解析 | 退货理由列表 |
| deliveryExpressEnabled | delivery_express_enabled | TINYINT(1) | 0/1→boolean | 是否启用快递发货 |
| deliveryExpressFreeEnabled | delivery_express_free_enabled | TINYINT(1) | 0/1→boolean | 是否启用全局包邮 |
| deliveryExpressFreePrice | delivery_express_free_price | BIGINT | 元×100/分÷100 | 满额包邮金额 |
| deliveryPickUpEnabled | delivery_pick_up_enabled | TINYINT(1) | 0/1→boolean | 是否启用门店自提 |
| deliverySameCityEnabled | delivery_same_city_enabled | TINYINT(1) | 0/1→boolean | 是否启用同城配送 |
| sameCityChargeMode | same_city_charge_mode | TINYINT | 无 | 计费方式 |
| sameCityStartDistance | same_city_start_distance | DECIMAL(10,2) | 无 | 起步距离（公里） |
| sameCityStartPrice | same_city_start_price | BIGINT | 元×100/分÷100 | 起步价 |
| sameCityExtraDistance | same_city_extra_distance | DECIMAL(10,2) | 无 | 续距（公里） |
| sameCityExtraPrice | same_city_extra_price | BIGINT | 元×100/分÷100 | 续费 |
| sameCityMaxDistance | same_city_max_distance | DECIMAL(10,2) | 无 | 最大配送距离（公里） |
| sameCityFixedPrice | same_city_fixed_price | BIGINT | 元×100/分÷100 | 固定配送费 |
| sameCityCustomPriceEnabled | same_city_custom_price_enabled | TINYINT(1) | 0/1→boolean | 是否启用自定义费用 |
| sameCityCustomMinPrice | same_city_custom_min_price | BIGINT | 元×100/分÷100 | 最低配送费 |
| sameCityCustomMaxPrice | same_city_custom_max_price | BIGINT | 元×100/分÷100 | 最高配送费 |
| sameCityCustomNeedAudit | same_city_custom_need_audit | TINYINT(1) | 0/1→boolean | 是否需要商家审核 |
| sameCityCustomDefaultPrice | same_city_custom_default_price | BIGINT | 元×100/分÷100 | 默认配送费 |
| sameCityFreeEnabled | same_city_free_enabled | TINYINT(1) | 0/1→boolean | 是否启用包邮 |
| sameCityFreePrice | same_city_free_price | BIGINT | 元×100/分÷100 | 满额包邮金额 |
| sameCityDeliveryCenterLatitude | same_city_delivery_center_latitude | DECIMAL(10,6) | 无 | 配送中心纬度 |
| sameCityDeliveryCenterLongitude | same_city_delivery_center_longitude | DECIMAL(11,6) | 无 | 配送中心经度 |
| sameCityDeliveryRange | same_city_delivery_range | DECIMAL(10,2) | 无 | 配送范围半径（公里） |
| sameCityDeliveryRangeDescription | same_city_delivery_range_description | TEXT | 无 | 配送范围限制说明 |
| deliveryStoreEnabled | delivery_store_enabled | TINYINT(1) | 0/1→boolean | 是否启用门店自配送 |
| storeChargeMode | store_charge_mode | TINYINT | 无 | 计费方式 |
| storeStartDistance | store_start_distance | DECIMAL(10,2) | 无 | 起步距离（公里） |
| storeStartPrice | store_start_price | BIGINT | 元×100/分÷100 | 起步价 |
| storeExtraDistance | store_extra_distance | DECIMAL(10,2) | 无 | 续距（公里） |
| storeExtraPrice | store_extra_price | BIGINT | 元×100/分÷100 | 续费 |
| storeMaxDistance | store_max_distance | DECIMAL(10,2) | 无 | 最大配送距离（公里） |
| storeFixedPrice | store_fixed_price | BIGINT | 元×100/分÷100 | 固定配送费 |
| storeCustomPriceEnabled | store_custom_price_enabled | TINYINT(1) | 0/1→boolean | 是否启用自定义费用 |
| storeCustomMinPrice | store_custom_min_price | BIGINT | 元×100/分÷100 | 最低配送费 |
| storeCustomMaxPrice | store_custom_max_price | BIGINT | 元×100/分÷100 | 最高配送费 |
| storeCustomNeedAudit | store_custom_need_audit | TINYINT(1) | 0/1→boolean | 是否需要商家审核 |
| storeCustomDefaultPrice | store_custom_default_price | BIGINT | 元×100/分÷100 | 默认配送费 |
| storeFreeEnabled | store_free_enabled | TINYINT(1) | 0/1→boolean | 是否启用包邮 |
| storeFreePrice | store_free_price | BIGINT | 元×100/分÷100 | 满额包邮金额 |
| storeDeliveryRangeImageUrl | store_delivery_range_image_url | VARCHAR(500) | 无 | 门店配送范围示意图URL |
| packagingFeeEnabled | packaging_fee_enabled | TINYINT(1) | 0/1→boolean | 是否启用包装费 |
| packagingFeePrice | packaging_fee_price | BIGINT | 元×100/分÷100 | 包装费金额 |
| brokerageEnabled | brokerage_enabled | TINYINT(1) | 0/1→boolean | 是否启用分销 |
| brokerageEnabledCondition | brokerage_enabled_condition | INT | 无 | 分佣模式 |
| brokerageBindMode | brokerage_bind_mode | INT | 无 | 分销关系绑定模式 |
| brokeragePosterUrls | brokerage_poster_urls | JSON | JSON解析 | 分销海报URL列表 |
| brokerageFirstPercent | brokerage_first_percent | INT | 无 | 一级返佣比例 |
| brokerageSecondPercent | brokerage_second_percent | INT | 无 | 二级返佣比例 |
| brokerageWithdrawMinPrice | brokerage_withdraw_min_price | BIGINT | 元×100/分÷100 | 提现最低金额 |
| brokerageWithdrawFeePercent | brokerage_withdraw_fee_percent | INT | 无 | 提现手续费百分比 |
| brokerageFrozenDays | brokerage_frozen_days | INT | 无 | 佣金冻结天数 |
| brokerageWithdrawTypes | brokerage_withdraw_types | JSON | JSON解析 | 提现方式列表 |

## 四、注意事项

1. **金额字段统一处理**：
   - 建议后端统一处理所有金额字段的转换
   - 前端提交时：元 → 分（× 100）
   - 后端返回时：分 → 元（÷ 100）

2. **JSON字段处理**：
   - MySQL JSON类型会自动验证格式
   - 前端需要处理JSON字符串和数组的转换

3. **单例模式约束**：
   - 表中只有一条记录（id=1）
   - 应用层需保证单例约束

4. **默认值设置**：
   - 所有字段都设置了合理的默认值
   - 前端可以为null的字段，后端允许NULL

5. **数据校验**：
   - 金额字段 >= 0
   - 距离字段 >= 0
   - 百分比字段范围 0-100
   - 坐标字段范围符合地理坐标规范

