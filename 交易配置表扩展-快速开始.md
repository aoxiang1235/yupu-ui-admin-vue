# 交易配置表扩展 - 快速开始指南

## 🎯 执行目标

在现有 `trade_config` 表基础上，新增**51个字段**：
- ✅ 快递发货启用开关（1个）
- ✅ 同城配送配置（30个）
- ✅ 门店自配送配置（20个）

## 📋 执行前准备

### 1. 备份数据库（必须！）
```bash
mysqldump -u用户名 -p数据库名 trade_config > trade_config_backup_$(date +%Y%m%d_%H%M%S).sql
```

### 2. 确认环境
- ✅ MySQL 版本 >= 5.7
- ✅ 有数据库操作权限
- ✅ 已备份数据库

## 🚀 三步执行

### 第一步：执行 ALTER 语句

```bash
# 方式1：命令行执行
mysql -u用户名 -p数据库名 < 交易配置表扩展ALTER语句.sql

# 方式2：在MySQL客户端中执行
mysql> source /path/to/交易配置表扩展ALTER语句.sql
```

**预计时间**：1-2分钟

### 第二步：验证扩展结果

```bash
# 执行验证脚本
mysql -u用户名 -p数据库名 < 交易配置表扩展验证脚本.sql
```

**检查要点**：
- ✅ 字段总数约70个
- ✅ 同城配送字段30个
- ✅ 门店自配送字段20个
- ✅ 所有字段都有默认值

### 第三步：验证数据

```sql
-- 快速验证
SELECT 
    delivery_express_enabled,
    delivery_same_city_enabled,
    delivery_store_enabled,
    same_city_charge_mode,
    store_charge_mode
FROM trade_config WHERE id = 1;
```

## ✅ 验证清单

执行后检查以下项目：

- [ ] 备份已创建
- [ ] ALTER语句执行成功（无错误）
- [ ] 字段总数约70个
- [ ] 同城配送字段30个
- [ ] 门店自配送字段20个
- [ ] 配置记录存在（id=1）
- [ ] 所有字段有默认值

## 📁 相关文件说明

| 文件名 | 用途 | 必须 |
|--------|------|------|
| `交易配置表扩展ALTER语句.sql` | 执行扩展的SQL脚本 | ✅ 必须 |
| `交易配置表扩展验证脚本.sql` | 验证扩展结果 | ⭐ 推荐 |
| `交易配置表扩展执行清单.md` | 详细执行步骤 | 📖 参考 |
| `交易配置表扩展方案总结.md` | 方案说明 | 📖 参考 |

## 🔧 常见问题

### Q1: 执行报错"Duplicate column name"
**原因**：字段已存在  
**解决**：检查是否已执行过扩展，或者手动删除重复字段

### Q2: 字段类型不匹配
**原因**：现有字段类型与扩展不一致  
**解决**：检查现有表结构，调整 ALTER 语句中的字段类型

### Q3: 默认值设置失败
**原因**：字段定义冲突  
**解决**：检查字段的 NULL/NOT NULL 约束，确保默认值合理

## 🔄 回滚方案

如果需要回滚：

```bash
# 恢复备份
mysql -u用户名 -p数据库名 < trade_config_backup_YYYYMMDD_HHMMSS.sql
```

或者使用 ALTER 语句文件中的回滚脚本（注释部分）

## 📞 需要帮助？

如果遇到问题：
1. 查看 `交易配置表扩展执行清单.md` 的详细说明
2. 检查验证脚本的输出结果
3. 查看MySQL错误日志
4. 联系数据库管理员

## ⏱️ 执行时间预估

- **备份数据库**：1-2分钟
- **执行ALTER语句**：1-2分钟
- **验证扩展结果**：1分钟
- **总计**：约3-5分钟

---

**🎉 执行完成后，记得更新后端代码和测试！**

